{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.213.0"},"children":{"VpcStack":{"id":"VpcStack","path":"VpcStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.213.0"},"children":{"MyVpc":{"id":"MyVpc","path":"VpcStack/MyVpc","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.Vpc","version":"2.213.0","metadata":[{"ipAddresses":"*","maxAzs":"*","subnetConfiguration":[],"natGateways":"*"}]},"children":{"Resource":{"id":"Resource","path":"VpcStack/MyVpc/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPC","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPC","aws:cdk:cloudformation:props":{"cidrBlock":"10.0.0.0/16","enableDnsHostnames":true,"enableDnsSupport":true,"instanceTenancy":"default","tags":[{"key":"Name","value":"VpcStack/MyVpc"}]}}},"RestrictDefaultSecurityGroupCustomResource":{"id":"RestrictDefaultSecurityGroupCustomResource","path":"VpcStack/MyVpc/RestrictDefaultSecurityGroupCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.213.0","metadata":["*"]},"children":{"Default":{"id":"Default","path":"VpcStack/MyVpc/RestrictDefaultSecurityGroupCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.213.0"}}}},"S3Endpoint":{"id":"S3Endpoint","path":"VpcStack/MyVpc/S3Endpoint","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.GatewayVpcEndpoint","version":"2.213.0","metadata":[{"vpc":"*","service":{"name":"*"},"subnets":[{"subnets":["*","*"]}]}]},"children":{"Resource":{"id":"Resource","path":"VpcStack/MyVpc/S3Endpoint/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCEndpoint","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCEndpoint","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"VpcStack/MyVpc"}],"routeTableIds":[{"Ref":"PrivateSubnetARouteTable6864ED5E"},{"Ref":"PrivateSubnetCRouteTable306C20EB"}],"serviceName":{"Fn::Join":["",["com.amazonaws.",{"Ref":"AWS::Region"},".s3"]]},"vpcEndpointType":"Gateway","vpcId":{"Ref":"MyVpcF9F0CA6F"}}}}}}}},"Custom::VpcRestrictDefaultSGCustomResourceProvider":{"id":"Custom::VpcRestrictDefaultSGCustomResourceProvider","path":"VpcStack/Custom::VpcRestrictDefaultSGCustomResourceProvider","constructInfo":{"fqn":"aws-cdk-lib.CustomResourceProviderBase","version":"2.213.0"},"children":{"Staging":{"id":"Staging","path":"VpcStack/Custom::VpcRestrictDefaultSGCustomResourceProvider/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.213.0"}},"Role":{"id":"Role","path":"VpcStack/Custom::VpcRestrictDefaultSGCustomResourceProvider/Role","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.213.0"}},"Handler":{"id":"Handler","path":"VpcStack/Custom::VpcRestrictDefaultSGCustomResourceProvider/Handler","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.213.0"}}}},"PublicSubnetA":{"id":"PublicSubnetA","path":"VpcStack/PublicSubnetA","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.Subnet","version":"2.213.0","metadata":[{"vpcId":"*","availabilityZone":"*","cidrBlock":"*","mapPublicIpOnLaunch":true}]},"children":{"Subnet":{"id":"Subnet","path":"VpcStack/PublicSubnetA/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"ap-northeast-1a","cidrBlock":"10.0.0.0/20","mapPublicIpOnLaunch":true,"tags":[{"key":"Name","value":"VpcStack/PublicSubnetA"}],"vpcId":{"Ref":"MyVpcF9F0CA6F"}}}},"Acl":{"id":"Acl","path":"VpcStack/PublicSubnetA/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.213.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"VpcStack/PublicSubnetA/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"VpcStack/PublicSubnetA"}],"vpcId":{"Ref":"MyVpcF9F0CA6F"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"VpcStack/PublicSubnetA/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"PublicSubnetARouteTable5125BE86"},"subnetId":{"Ref":"PublicSubnetASubnet3D1343B6"}}}}}},"PublicSubnetC":{"id":"PublicSubnetC","path":"VpcStack/PublicSubnetC","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.Subnet","version":"2.213.0","metadata":[{"vpcId":"*","availabilityZone":"*","cidrBlock":"*","mapPublicIpOnLaunch":true}]},"children":{"Subnet":{"id":"Subnet","path":"VpcStack/PublicSubnetC/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"ap-northeast-1c","cidrBlock":"10.0.16.0/20","mapPublicIpOnLaunch":true,"tags":[{"key":"Name","value":"VpcStack/PublicSubnetC"}],"vpcId":{"Ref":"MyVpcF9F0CA6F"}}}},"Acl":{"id":"Acl","path":"VpcStack/PublicSubnetC/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.213.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"VpcStack/PublicSubnetC/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"VpcStack/PublicSubnetC"}],"vpcId":{"Ref":"MyVpcF9F0CA6F"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"VpcStack/PublicSubnetC/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"PublicSubnetCRouteTable3EAD8380"},"subnetId":{"Ref":"PublicSubnetCSubnet175E3284"}}}}}},"PrivateSubnetA":{"id":"PrivateSubnetA","path":"VpcStack/PrivateSubnetA","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.Subnet","version":"2.213.0","metadata":[{"vpcId":"*","availabilityZone":"*","cidrBlock":"*","mapPublicIpOnLaunch":false}]},"children":{"Subnet":{"id":"Subnet","path":"VpcStack/PrivateSubnetA/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"ap-northeast-1a","cidrBlock":"10.0.128.0/20","mapPublicIpOnLaunch":false,"tags":[{"key":"Name","value":"VpcStack/PrivateSubnetA"}],"vpcId":{"Ref":"MyVpcF9F0CA6F"}}}},"Acl":{"id":"Acl","path":"VpcStack/PrivateSubnetA/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.213.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"VpcStack/PrivateSubnetA/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"VpcStack/PrivateSubnetA"}],"vpcId":{"Ref":"MyVpcF9F0CA6F"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"VpcStack/PrivateSubnetA/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"PrivateSubnetARouteTable6864ED5E"},"subnetId":{"Ref":"PrivateSubnetASubnet0C8C29C1"}}}}}},"PrivateSubnetC":{"id":"PrivateSubnetC","path":"VpcStack/PrivateSubnetC","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.Subnet","version":"2.213.0","metadata":[{"vpcId":"*","availabilityZone":"*","cidrBlock":"*","mapPublicIpOnLaunch":false}]},"children":{"Subnet":{"id":"Subnet","path":"VpcStack/PrivateSubnetC/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"ap-northeast-1c","cidrBlock":"10.0.144.0/20","mapPublicIpOnLaunch":false,"tags":[{"key":"Name","value":"VpcStack/PrivateSubnetC"}],"vpcId":{"Ref":"MyVpcF9F0CA6F"}}}},"Acl":{"id":"Acl","path":"VpcStack/PrivateSubnetC/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.213.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"VpcStack/PrivateSubnetC/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"VpcStack/PrivateSubnetC"}],"vpcId":{"Ref":"MyVpcF9F0CA6F"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"VpcStack/PrivateSubnetC/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"PrivateSubnetCRouteTable306C20EB"},"subnetId":{"Ref":"PrivateSubnetCSubnet439D5A9F"}}}}}},"InternetGateway":{"id":"InternetGateway","path":"VpcStack/InternetGateway","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnInternetGateway","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::InternetGateway","aws:cdk:cloudformation:props":{}}},"VpcIgwAttach":{"id":"VpcIgwAttach","path":"VpcStack/VpcIgwAttach","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCGatewayAttachment","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCGatewayAttachment","aws:cdk:cloudformation:props":{"internetGatewayId":{"Ref":"InternetGateway"},"vpcId":{"Ref":"MyVpcF9F0CA6F"}}}},"PublicRouteTable":{"id":"PublicRouteTable","path":"VpcStack/PublicRouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"vpcId":{"Ref":"MyVpcF9F0CA6F"}}}},"PublicDefaultRoute":{"id":"PublicDefaultRoute","path":"VpcStack/PublicDefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","gatewayId":{"Ref":"InternetGateway"},"routeTableId":{"Ref":"PublicRouteTable"}}}},"PubSubnetA_RTA":{"id":"PubSubnetA_RTA","path":"VpcStack/PubSubnetA_RTA","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"PublicRouteTable"},"subnetId":{"Ref":"PublicSubnetASubnet3D1343B6"}}}},"PubSubnetC_RTA":{"id":"PubSubnetC_RTA","path":"VpcStack/PubSubnetC_RTA","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"PublicRouteTable"},"subnetId":{"Ref":"PublicSubnetCSubnet175E3284"}}}},"PrivateRouteTable":{"id":"PrivateRouteTable","path":"VpcStack/PrivateRouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"vpcId":{"Ref":"MyVpcF9F0CA6F"}}}},"PrivSubnetA_RTA":{"id":"PrivSubnetA_RTA","path":"VpcStack/PrivSubnetA_RTA","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"PrivateRouteTable"},"subnetId":{"Ref":"PrivateSubnetASubnet0C8C29C1"}}}},"PrivSubnetC_RTA":{"id":"PrivSubnetC_RTA","path":"VpcStack/PrivSubnetC_RTA","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"PrivateRouteTable"},"subnetId":{"Ref":"PrivateSubnetCSubnet439D5A9F"}}}},"VpcId":{"id":"VpcId","path":"VpcStack/VpcId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.213.0"}},"PublicSubnets":{"id":"PublicSubnets","path":"VpcStack/PublicSubnets","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.213.0"}},"PrivateSubnets":{"id":"PrivateSubnets","path":"VpcStack/PrivateSubnets","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.213.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"VpcStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"VpcStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.213.0"}}}},"Exports":{"id":"Exports","path":"VpcStack/Exports","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Output{\"Ref\":\"MyVpcF9F0CA6F\"}":{"id":"Output{\"Ref\":\"MyVpcF9F0CA6F\"}","path":"VpcStack/Exports/Output{\"Ref\":\"MyVpcF9F0CA6F\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.213.0"}},"Output{\"Ref\":\"PrivateSubnetASubnet0C8C29C1\"}":{"id":"Output{\"Ref\":\"PrivateSubnetASubnet0C8C29C1\"}","path":"VpcStack/Exports/Output{\"Ref\":\"PrivateSubnetASubnet0C8C29C1\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.213.0"}},"Output{\"Ref\":\"PrivateSubnetCSubnet439D5A9F\"}":{"id":"Output{\"Ref\":\"PrivateSubnetCSubnet439D5A9F\"}","path":"VpcStack/Exports/Output{\"Ref\":\"PrivateSubnetCSubnet439D5A9F\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.213.0"}},"Output{\"Ref\":\"PublicSubnetASubnet3D1343B6\"}":{"id":"Output{\"Ref\":\"PublicSubnetASubnet3D1343B6\"}","path":"VpcStack/Exports/Output{\"Ref\":\"PublicSubnetASubnet3D1343B6\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.213.0"}},"Output{\"Ref\":\"PublicSubnetCSubnet175E3284\"}":{"id":"Output{\"Ref\":\"PublicSubnetCSubnet175E3284\"}","path":"VpcStack/Exports/Output{\"Ref\":\"PublicSubnetCSubnet175E3284\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.213.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"VpcStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.213.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"VpcStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.213.0"}}}},"SecurityStack":{"id":"SecurityStack","path":"SecurityStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.213.0"},"children":{"AlbSg":{"id":"AlbSg","path":"SecurityStack/AlbSg","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.213.0","metadata":[{"vpc":"*","description":"*","allowAllOutbound":true},{"addIngressRule":[{"canInlineRule":true,"connections":"*","uniqueId":"*"},{},"*"]},{"addIngressRule":[{"canInlineRule":true,"connections":"*","uniqueId":"*"},{},"*",false]},{"addEgressRule":["*",{},"*",true]}]},"children":{"Resource":{"id":"Resource","path":"SecurityStack/AlbSg/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"ALB security group (HTTP)","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"securityGroupIngress":[{"cidrIp":"0.0.0.0/0","ipProtocol":"tcp","fromPort":80,"toPort":80,"description":"Allow HTTP"}],"vpcId":{"Fn::ImportValue":"VpcStack:ExportsOutputRefMyVpcF9F0CA6FBC8737E9"}}}}}},"EcsSg":{"id":"EcsSg","path":"SecurityStack/EcsSg","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.213.0","metadata":[{"vpc":"*","description":"*","allowAllOutbound":true},{"addIngressRule":["*",{},"*"]},{"addIngressRule":["*",{},"*",false]}]},"children":{"Resource":{"id":"Resource","path":"SecurityStack/EcsSg/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"ECS tasks security group","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"vpcId":{"Fn::ImportValue":"VpcStack:ExportsOutputRefMyVpcF9F0CA6FBC8737E9"}}}},"from SecurityStackAlbSg848EA823:80":{"id":"from SecurityStackAlbSg848EA823:80","path":"SecurityStack/EcsSg/from SecurityStackAlbSg848EA823:80","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroupIngress","aws:cdk:cloudformation:props":{"description":"Allow ALB -> ECS","fromPort":80,"groupId":{"Fn::GetAtt":["EcsSg17B4B0B3","GroupId"]},"ipProtocol":"tcp","sourceSecurityGroupId":{"Fn::GetAtt":["AlbSg1155C1BE","GroupId"]},"toPort":80}}}}},"RdsSg":{"id":"RdsSg","path":"SecurityStack/RdsSg","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.213.0","metadata":[{"vpc":"*","description":"*","allowAllOutbound":true},{"addIngressRule":["*",{},"*"]}]},"children":{"Resource":{"id":"Resource","path":"SecurityStack/RdsSg/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"RDS security group","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"vpcId":{"Fn::ImportValue":"VpcStack:ExportsOutputRefMyVpcF9F0CA6FBC8737E9"}}}},"from SecurityStackEcsSgC0494B04:3306":{"id":"from SecurityStackEcsSgC0494B04:3306","path":"SecurityStack/RdsSg/from SecurityStackEcsSgC0494B04:3306","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroupIngress","aws:cdk:cloudformation:props":{"description":"Allow ECS -> RDS (MySQL)","fromPort":3306,"groupId":{"Fn::GetAtt":["RdsSg7F9F43B6","GroupId"]},"ipProtocol":"tcp","sourceSecurityGroupId":{"Fn::GetAtt":["EcsSg17B4B0B3","GroupId"]},"toPort":3306}}}}},"EcsTaskRole":{"id":"EcsTaskRole","path":"SecurityStack/EcsTaskRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.213.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"description":"*"},{"addToPolicy":[{}]},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]}]},"children":{"ImportEcsTaskRole":{"id":"ImportEcsTaskRole","path":"SecurityStack/EcsTaskRole/ImportEcsTaskRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.213.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"SecurityStack/EcsTaskRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"ecs-tasks.amazonaws.com"}}],"Version":"2012-10-17"},"description":"Task role for ECS tasks (app role)"}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"SecurityStack/EcsTaskRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.213.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"SecurityStack/EcsTaskRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject","s3:ListBucket"],"Effect":"Allow","Resource":["arn:aws:s3:::your-bucket-name","arn:aws:s3:::your-bucket-name/*"]}],"Version":"2012-10-17"},"policyName":"EcsTaskRoleDefaultPolicy50882C77","roles":[{"Ref":"EcsTaskRole8DFA0181"}]}}}}}}},"EcsExecutionRole":{"id":"EcsExecutionRole","path":"SecurityStack/EcsExecutionRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.213.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"managedPolicies":[{"managedPolicyArn":"*"}]}]},"children":{"ImportEcsExecutionRole":{"id":"ImportEcsExecutionRole","path":"SecurityStack/EcsExecutionRole/ImportEcsExecutionRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.213.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"SecurityStack/EcsExecutionRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"ecs-tasks.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"]]}]}}}}},"EcsTaskRoleArn":{"id":"EcsTaskRoleArn","path":"SecurityStack/EcsTaskRoleArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.213.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"SecurityStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"SecurityStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.213.0"}}}},"Exports":{"id":"Exports","path":"SecurityStack/Exports","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Output{\"Fn::GetAtt\":[\"RdsSg7F9F43B6\",\"GroupId\"]}":{"id":"Output{\"Fn::GetAtt\":[\"RdsSg7F9F43B6\",\"GroupId\"]}","path":"SecurityStack/Exports/Output{\"Fn::GetAtt\":[\"RdsSg7F9F43B6\",\"GroupId\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.213.0"}},"Output{\"Fn::GetAtt\":[\"EcsTaskRole8DFA0181\",\"Arn\"]}":{"id":"Output{\"Fn::GetAtt\":[\"EcsTaskRole8DFA0181\",\"Arn\"]}","path":"SecurityStack/Exports/Output{\"Fn::GetAtt\":[\"EcsTaskRole8DFA0181\",\"Arn\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.213.0"}},"Output{\"Fn::GetAtt\":[\"EcsSg17B4B0B3\",\"GroupId\"]}":{"id":"Output{\"Fn::GetAtt\":[\"EcsSg17B4B0B3\",\"GroupId\"]}","path":"SecurityStack/Exports/Output{\"Fn::GetAtt\":[\"EcsSg17B4B0B3\",\"GroupId\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.213.0"}},"Output{\"Fn::GetAtt\":[\"AlbSg1155C1BE\",\"GroupId\"]}":{"id":"Output{\"Fn::GetAtt\":[\"AlbSg1155C1BE\",\"GroupId\"]}","path":"SecurityStack/Exports/Output{\"Fn::GetAtt\":[\"AlbSg1155C1BE\",\"GroupId\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.213.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"SecurityStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.213.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"SecurityStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.213.0"}}}},"RdsStack":{"id":"RdsStack","path":"RdsStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.213.0"},"children":{"RdsSecret":{"id":"RdsSecret","path":"RdsStack/RdsSecret","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.213.0","metadata":[{"secretName":"*","generateSecretString":{"secretStringTemplate":"*","excludePunctuation":true,"includeSpace":false,"generateStringKey":"*"}}]},"children":{"Resource":{"id":"Resource","path":"RdsStack/RdsSecret/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"generateSecretString":{"secretStringTemplate":"{\"username\":\"dbadmin\"}","excludePunctuation":true,"includeSpace":false,"generateStringKey":"password"},"name":"RdsStack-db-credentials"}}},"Attachment":{"id":"Attachment","path":"RdsStack/RdsSecret/Attachment","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.SecretTargetAttachment","version":"2.213.0","metadata":[{"secret":"*","target":"*"}]},"children":{"Resource":{"id":"Resource","path":"RdsStack/RdsSecret/Attachment/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecretTargetAttachment","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::SecretTargetAttachment","aws:cdk:cloudformation:props":{"secretId":{"Ref":"RdsSecretB2B964C3"},"targetId":{"Ref":"AppRdsE6D3399A"},"targetType":"AWS::RDS::DBInstance"}}}}}}},"RdsSubnetGroup":{"id":"RdsSubnetGroup","path":"RdsStack/RdsSubnetGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_rds.SubnetGroup","version":"2.213.0","metadata":[{"vpc":"*","vpcSubnets":{"subnets":["*","*"]},"description":"*","removalPolicy":"destroy"}]},"children":{"Default":{"id":"Default","path":"RdsStack/RdsSubnetGroup/Default","constructInfo":{"fqn":"aws-cdk-lib.aws_rds.CfnDBSubnetGroup","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::RDS::DBSubnetGroup","aws:cdk:cloudformation:props":{"dbSubnetGroupDescription":"Subnet group for RDS","subnetIds":[{"Fn::ImportValue":"VpcStack:ExportsOutputRefPrivateSubnetASubnet0C8C29C18A1DB0CD"},{"Fn::ImportValue":"VpcStack:ExportsOutputRefPrivateSubnetCSubnet439D5A9F2269D6CA"}]}}}}},"AppRds":{"id":"AppRds","path":"RdsStack/AppRds","constructInfo":{"fqn":"aws-cdk-lib.aws_rds.DatabaseInstance","version":"2.213.0","metadata":[{"engine":{"engineType":"*","singleUserRotationApplication":"*","engineVersion":{"fullVersion":"*","majorVersion":"*"},"parameterGroupFamily":"*","engineFamily":"*","supportsReadReplicaBackups":true},"vpc":"*","vpcSubnets":{"subnets":["*","*"]},"securityGroups":["*"],"credentials":"*","allocatedStorage":"*","storageType":"gp3","multiAz":true,"subnetGroup":"*","publiclyAccessible":false,"backupRetention":"*","deletionProtection":false,"removalPolicy":"destroy"}]},"children":{"Resource":{"id":"Resource","path":"RdsStack/AppRds/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_rds.CfnDBInstance","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::RDS::DBInstance","aws:cdk:cloudformation:props":{"allocatedStorage":"20","backupRetentionPeriod":7,"copyTagsToSnapshot":true,"dbInstanceClass":"db.m5.large","dbSubnetGroupName":{"Ref":"RdsSubnetGroup"},"deletionProtection":false,"engine":"mysql","engineVersion":"8.0.33","masterUsername":{"Fn::Join":["",["{{resolve:secretsmanager:",{"Ref":"RdsSecretB2B964C3"},":SecretString:username::}}"]]},"masterUserPassword":{"Fn::Join":["",["{{resolve:secretsmanager:",{"Ref":"RdsSecretB2B964C3"},":SecretString:password::}}"]]},"multiAz":true,"publiclyAccessible":false,"storageType":"gp3","vpcSecurityGroups":[{"Fn::ImportValue":"SecurityStack:ExportsOutputFnGetAttRdsSg7F9F43B6GroupId133E31A8"}]}}}}},"RdsEndpoint":{"id":"RdsEndpoint","path":"RdsStack/RdsEndpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.213.0"}},"RdsSecretArn":{"id":"RdsSecretArn","path":"RdsStack/RdsSecretArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.213.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"RdsStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"RdsStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.213.0"}}}},"Exports":{"id":"Exports","path":"RdsStack/Exports","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Output{\"Ref\":\"AppRdsE6D3399A\"}":{"id":"Output{\"Ref\":\"AppRdsE6D3399A\"}","path":"RdsStack/Exports/Output{\"Ref\":\"AppRdsE6D3399A\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.213.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"RdsStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.213.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"RdsStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.213.0"}}}},"ServiceStack":{"id":"ServiceStack","path":"ServiceStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.213.0"},"children":{"EcsCluster":{"id":"EcsCluster","path":"ServiceStack/EcsCluster","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.Cluster","version":"2.213.0","metadata":[{"vpc":"*"}]},"children":{"Resource":{"id":"Resource","path":"ServiceStack/EcsCluster/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.CfnCluster","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ECS::Cluster","aws:cdk:cloudformation:props":{}}}}},"ExecutionRole":{"id":"ExecutionRole","path":"ServiceStack/ExecutionRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.213.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"managedPolicies":[{"managedPolicyArn":"*"}]},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]}]},"children":{"ImportExecutionRole":{"id":"ImportExecutionRole","path":"ServiceStack/ExecutionRole/ImportExecutionRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.213.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ServiceStack/ExecutionRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"ecs-tasks.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ServiceStack/ExecutionRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.213.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"ServiceStack/ExecutionRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["logs:CreateLogStream","logs:PutLogEvents"],"Effect":"Allow","Resource":{"Fn::GetAtt":["AppLogGroup7D8CD952","Arn"]}}],"Version":"2012-10-17"},"policyName":"ExecutionRoleDefaultPolicyA5B92313","roles":[{"Ref":"ExecutionRole605A040B"}]}}}}}}},"TaskDef":{"id":"TaskDef","path":"ServiceStack/TaskDef","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.FargateTaskDefinition","version":"2.213.0","metadata":["*","*","*","*","*"]},"children":{"Resource":{"id":"Resource","path":"ServiceStack/TaskDef/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.CfnTaskDefinition","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ECS::TaskDefinition","aws:cdk:cloudformation:props":{"containerDefinitions":[{"essential":true,"image":"nginx:latest","name":"AppContainer","portMappings":[{"containerPort":80,"protocol":"tcp"}],"logConfiguration":{"logDriver":"awslogs","options":{"awslogs-group":{"Ref":"AppLogGroup7D8CD952"},"awslogs-stream-prefix":"app","awslogs-region":"ap-northeast-1"}}}],"cpu":"256","executionRoleArn":{"Fn::GetAtt":["ExecutionRole605A040B","Arn"]},"family":"ServiceStackTaskDefFD38CFA7","memory":"512","networkMode":"awsvpc","requiresCompatibilities":["FARGATE"],"taskRoleArn":{"Fn::ImportValue":"SecurityStack:ExportsOutputFnGetAttEcsTaskRole8DFA0181Arn43EC6E0B"}}}},"AppContainer":{"id":"AppContainer","path":"ServiceStack/TaskDef/AppContainer","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.ContainerDefinition","version":"2.213.0"}}}},"AppLogGroup":{"id":"AppLogGroup","path":"ServiceStack/AppLogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.213.0","metadata":[{"retention":7,"removalPolicy":"destroy"}]},"children":{"Resource":{"id":"Resource","path":"ServiceStack/AppLogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"retentionInDays":7}}}}},"FargateService":{"id":"FargateService","path":"ServiceStack/FargateService","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.FargateService","version":"2.213.0","metadata":["*"]},"children":{"Service":{"id":"Service","path":"ServiceStack/FargateService/Service","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.CfnService","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ECS::Service","aws:cdk:cloudformation:props":{"cluster":{"Ref":"EcsCluster97242B84"},"deploymentConfiguration":{"maximumPercent":200,"minimumHealthyPercent":50},"desiredCount":2,"enableEcsManagedTags":false,"healthCheckGracePeriodSeconds":60,"launchType":"FARGATE","loadBalancers":[{"targetGroupArn":{"Ref":"AppTG218EBF05"},"containerName":"AppContainer","containerPort":80}],"networkConfiguration":{"awsvpcConfiguration":{"assignPublicIp":"DISABLED","subnets":[{"Fn::ImportValue":"VpcStack:ExportsOutputRefPrivateSubnetASubnet0C8C29C18A1DB0CD"},{"Fn::ImportValue":"VpcStack:ExportsOutputRefPrivateSubnetCSubnet439D5A9F2269D6CA"}],"securityGroups":[{"Fn::ImportValue":"SecurityStack:ExportsOutputFnGetAttEcsSg17B4B0B3GroupIdF7EB5B8E"}]}},"taskDefinition":{"Ref":"TaskDef54694570"}}}},"ScalingRole":{"id":"ScalingRole","path":"ServiceStack/FargateService/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.213.0","metadata":["*"]}},"TaskCount":{"id":"TaskCount","path":"ServiceStack/FargateService/TaskCount","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.ScalableTaskCount","version":"2.213.0"},"children":{"Target":{"id":"Target","path":"ServiceStack/FargateService/TaskCount/Target","constructInfo":{"fqn":"aws-cdk-lib.aws_applicationautoscaling.ScalableTarget","version":"2.213.0","metadata":[{"serviceNamespace":"ecs","scalableDimension":"*","resourceId":"*","role":"*","minCapacity":"*","maxCapacity":"*"},{"scaleToTrackMetric":["*",{"predefinedMetric":"*","policyName":"*","disableScaleIn":"*","targetValue":"*","scaleInCooldown":"*"}]},{"scaleOnMetric":["*",{"metric":{"warnings":"*"},"scalingSteps":[{"upper":"*","change":"*"},{"lower":"*","change":"*"}],"adjustmentType":"ChangeInCapacity"}]}]},"children":{"Resource":{"id":"Resource","path":"ServiceStack/FargateService/TaskCount/Target/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_applicationautoscaling.CfnScalableTarget","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApplicationAutoScaling::ScalableTarget","aws:cdk:cloudformation:props":{"maxCapacity":6,"minCapacity":2,"resourceId":{"Fn::Join":["",["service/",{"Ref":"EcsCluster97242B84"},"/",{"Fn::GetAtt":["FargateServiceAC2B3B85","Name"]}]]},"roleArn":{"Fn::Join":["",["arn:aws:iam::",{"Ref":"AWS::AccountId"},":role/aws-service-role/ecs.application-autoscaling.amazonaws.com/AWSServiceRoleForApplicationAutoScaling_ECSService"]]},"scalableDimension":"ecs:service:DesiredCount","serviceNamespace":"ecs"}}},"CpuScaling":{"id":"CpuScaling","path":"ServiceStack/FargateService/TaskCount/Target/CpuScaling","constructInfo":{"fqn":"aws-cdk-lib.aws_applicationautoscaling.TargetTrackingScalingPolicy","version":"2.213.0"},"children":{"Resource":{"id":"Resource","path":"ServiceStack/FargateService/TaskCount/Target/CpuScaling/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_applicationautoscaling.CfnScalingPolicy","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApplicationAutoScaling::ScalingPolicy","aws:cdk:cloudformation:props":{"policyName":"ServiceStackFargateServiceTaskCountTargetCpuScalingD7418F79","policyType":"TargetTrackingScaling","scalingTargetId":{"Ref":"FargateServiceTaskCountTarget8CF96FEA"},"targetTrackingScalingPolicyConfiguration":{"predefinedMetricSpecification":{"predefinedMetricType":"ECSServiceAverageCPUUtilization"},"scaleInCooldown":60,"scaleOutCooldown":60,"targetValue":70}}}}}},"PendingTasksScaling":{"id":"PendingTasksScaling","path":"ServiceStack/FargateService/TaskCount/Target/PendingTasksScaling","constructInfo":{"fqn":"aws-cdk-lib.aws_applicationautoscaling.StepScalingPolicy","version":"2.213.0"},"children":{"UpperPolicy":{"id":"UpperPolicy","path":"ServiceStack/FargateService/TaskCount/Target/PendingTasksScaling/UpperPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_applicationautoscaling.StepScalingAction","version":"2.213.0"},"children":{"Resource":{"id":"Resource","path":"ServiceStack/FargateService/TaskCount/Target/PendingTasksScaling/UpperPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_applicationautoscaling.CfnScalingPolicy","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApplicationAutoScaling::ScalingPolicy","aws:cdk:cloudformation:props":{"policyName":"ServiceStackFargateServiceTaskCountTargetPendingTasksScalingUpperPolicy20F1FCD7","policyType":"StepScaling","scalingTargetId":{"Ref":"FargateServiceTaskCountTarget8CF96FEA"},"stepScalingPolicyConfiguration":{"adjustmentType":"ChangeInCapacity","metricAggregationType":"Average","stepAdjustments":[{"metricIntervalLowerBound":0,"scalingAdjustment":1}]}}}}}},"UpperAlarm":{"id":"UpperAlarm","path":"ServiceStack/FargateService/TaskCount/Target/PendingTasksScaling/UpperAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.213.0","metadata":[{"metric":{"warnings":"*"},"alarmDescription":"*","comparisonOperator":"*","evaluationPeriods":"*","datapointsToAlarm":"*","threshold":"*"},{"addAlarmAction":[{}]}]},"children":{"Resource":{"id":"Resource","path":"ServiceStack/FargateService/TaskCount/Target/PendingTasksScaling/UpperAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"FargateServiceTaskCountTargetPendingTasksScalingUpperPolicy65BAF141"}],"alarmDescription":"Upper threshold scaling alarm","comparisonOperator":"GreaterThanOrEqualToThreshold","dimensions":[{"name":"ClusterName","value":{"Ref":"EcsCluster97242B84"}},{"name":"ServiceName","value":{"Fn::GetAtt":["FargateServiceAC2B3B85","Name"]}}],"evaluationPeriods":1,"metricName":"PendingTaskCount","namespace":"AWS/ECS","period":60,"statistic":"Average","threshold":1}}}}}}}}}}}}},"AppALB":{"id":"AppALB","path":"ServiceStack/AppALB","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationLoadBalancer","version":"2.213.0","metadata":["*","*"]},"children":{"Resource":{"id":"Resource","path":"ServiceStack/AppALB/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.CfnLoadBalancer","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ElasticLoadBalancingV2::LoadBalancer","aws:cdk:cloudformation:props":{"loadBalancerAttributes":[{"key":"deletion_protection.enabled","value":"false"}],"scheme":"internet-facing","securityGroups":[{"Fn::ImportValue":"SecurityStack:ExportsOutputFnGetAttAlbSg1155C1BEGroupIdF2A72E65"}],"subnets":[{"Fn::ImportValue":"VpcStack:ExportsOutputRefPublicSubnetASubnet3D1343B61C9C52D5"},{"Fn::ImportValue":"VpcStack:ExportsOutputRefPublicSubnetCSubnet175E3284C0A9E25D"}],"type":"application"}}},"HttpListener":{"id":"HttpListener","path":"ServiceStack/AppALB/HttpListener","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationListener","version":"2.213.0","metadata":["*","*","*"]},"children":{"Resource":{"id":"Resource","path":"ServiceStack/AppALB/HttpListener/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.CfnListener","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ElasticLoadBalancingV2::Listener","aws:cdk:cloudformation:props":{"defaultActions":[{"type":"forward","targetGroupArn":{"Ref":"AppTG218EBF05"}}],"loadBalancerArn":{"Ref":"AppALBDBE7026A"},"port":80,"protocol":"HTTP"}}}}}}},"AppTG":{"id":"AppTG","path":"ServiceStack/AppTG","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationTargetGroup","version":"2.213.0"},"children":{"Resource":{"id":"Resource","path":"ServiceStack/AppTG/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.CfnTargetGroup","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ElasticLoadBalancingV2::TargetGroup","aws:cdk:cloudformation:props":{"healthCheckIntervalSeconds":30,"healthCheckPath":"/healthcheck","healthCheckTimeoutSeconds":5,"matcher":{"httpCode":"200"},"port":80,"protocol":"HTTP","targetGroupAttributes":[{"key":"stickiness.enabled","value":"false"}],"targetType":"ip","vpcId":{"Fn::ImportValue":"VpcStack:ExportsOutputRefMyVpcF9F0CA6FBC8737E9"}}}}}},"CDKMetadata":{"id":"CDKMetadata","path":"ServiceStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"ServiceStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.213.0"}}}},"Exports":{"id":"Exports","path":"ServiceStack/Exports","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Output{\"Ref\":\"EcsCluster97242B84\"}":{"id":"Output{\"Ref\":\"EcsCluster97242B84\"}","path":"ServiceStack/Exports/Output{\"Ref\":\"EcsCluster97242B84\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.213.0"}},"Output{\"Fn::GetAtt\":[\"FargateServiceAC2B3B85\",\"Name\"]}":{"id":"Output{\"Fn::GetAtt\":[\"FargateServiceAC2B3B85\",\"Name\"]}","path":"ServiceStack/Exports/Output{\"Fn::GetAtt\":[\"FargateServiceAC2B3B85\",\"Name\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.213.0"}},"Output{\"Ref\":\"AppALBHttpListener82C680E9\"}":{"id":"Output{\"Ref\":\"AppALBHttpListener82C680E9\"}","path":"ServiceStack/Exports/Output{\"Ref\":\"AppALBHttpListener82C680E9\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.213.0"}},"Output{\"Fn::GetAtt\":[\"AppTG218EBF05\",\"TargetGroupFullName\"]}":{"id":"Output{\"Fn::GetAtt\":[\"AppTG218EBF05\",\"TargetGroupFullName\"]}","path":"ServiceStack/Exports/Output{\"Fn::GetAtt\":[\"AppTG218EBF05\",\"TargetGroupFullName\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.213.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"ServiceStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.213.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"ServiceStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.213.0"}}}},"MonitoringStack":{"id":"MonitoringStack","path":"MonitoringStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.213.0"},"children":{"AlarmTopic":{"id":"AlarmTopic","path":"MonitoringStack/AlarmTopic","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.Topic","version":"2.213.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"MonitoringStack/AlarmTopic/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnTopic","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::Topic","aws:cdk:cloudformation:props":{}}}}},"EcsCpuAlarm":{"id":"EcsCpuAlarm","path":"MonitoringStack/EcsCpuAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.213.0","metadata":[{"metric":{"warnings":"*"},"threshold":"*","evaluationPeriods":"*","comparisonOperator":"*","treatMissingData":"notBreaching"},{"addAlarmAction":[{}]}]},"children":{"Resource":{"id":"Resource","path":"MonitoringStack/EcsCpuAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"AlarmTopicD01E77F9"}],"comparisonOperator":"GreaterThanOrEqualToThreshold","dimensions":[{"name":"ClusterName","value":{"Fn::ImportValue":"ServiceStack:ExportsOutputRefEcsCluster97242B84553A5D8F"}},{"name":"ServiceName","value":{"Fn::ImportValue":"ServiceStack:ExportsOutputFnGetAttFargateServiceAC2B3B85NameFCF2B9A2"}}],"evaluationPeriods":2,"metricName":"CPUUtilization","namespace":"AWS/ECS","period":300,"statistic":"Average","threshold":80,"treatMissingData":"notBreaching"}}}}},"EcsPendingAlarm":{"id":"EcsPendingAlarm","path":"MonitoringStack/EcsPendingAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.213.0","metadata":[{"metric":{"warnings":"*"},"threshold":"*","evaluationPeriods":"*","comparisonOperator":"*"},{"addAlarmAction":[{}]}]},"children":{"Resource":{"id":"Resource","path":"MonitoringStack/EcsPendingAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"AlarmTopicD01E77F9"}],"comparisonOperator":"GreaterThanOrEqualToThreshold","dimensions":[{"name":"ClusterName","value":{"Fn::ImportValue":"ServiceStack:ExportsOutputRefEcsCluster97242B84553A5D8F"}},{"name":"ServiceName","value":{"Fn::ImportValue":"ServiceStack:ExportsOutputFnGetAttFargateServiceAC2B3B85NameFCF2B9A2"}}],"evaluationPeriods":2,"metricName":"PendingTaskCount","namespace":"AWS/ECS","period":60,"statistic":"Average","threshold":1}}}}},"Alb5xxAlarm":{"id":"Alb5xxAlarm","path":"MonitoringStack/Alb5xxAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.213.0","metadata":[{"metric":{"warnings":"*"},"threshold":"*","evaluationPeriods":"*","comparisonOperator":"*"},{"addAlarmAction":[{}]}]},"children":{"Resource":{"id":"Resource","path":"MonitoringStack/Alb5xxAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"AlarmTopicD01E77F9"}],"comparisonOperator":"GreaterThanOrEqualToThreshold","dimensions":[{"name":"LoadBalancer","value":{"Fn::Join":["",[{"Fn::Select":[1,{"Fn::Split":["/",{"Fn::ImportValue":"ServiceStack:ExportsOutputRefAppALBHttpListener82C680E91A33606C"}]}]},"/",{"Fn::Select":[2,{"Fn::Split":["/",{"Fn::ImportValue":"ServiceStack:ExportsOutputRefAppALBHttpListener82C680E91A33606C"}]}]},"/",{"Fn::Select":[3,{"Fn::Split":["/",{"Fn::ImportValue":"ServiceStack:ExportsOutputRefAppALBHttpListener82C680E91A33606C"}]}]}]]}},{"name":"TargetGroup","value":{"Fn::ImportValue":"ServiceStack:ExportsOutputFnGetAttAppTG218EBF05TargetGroupFullName4F43E5AC"}}],"evaluationPeriods":5,"metricName":"HTTPCode_Target_5XX_Count","namespace":"AWS/ApplicationELB","period":60,"statistic":"Sum","threshold":5}}}}},"RdsStorageAlarm":{"id":"RdsStorageAlarm","path":"MonitoringStack/RdsStorageAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.213.0","metadata":[{"metric":{"warnings":"*"},"threshold":"*","evaluationPeriods":"*","comparisonOperator":"*"},{"addAlarmAction":[{}]}]},"children":{"Resource":{"id":"Resource","path":"MonitoringStack/RdsStorageAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.213.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"AlarmTopicD01E77F9"}],"comparisonOperator":"LessThanThreshold","dimensions":[{"name":"DBInstanceIdentifier","value":{"Fn::ImportValue":"RdsStack:ExportsOutputRefAppRdsE6D3399A2CC540F6"}}],"evaluationPeriods":1,"metricName":"FreeStorageSpace","namespace":"AWS/RDS","period":300,"statistic":"Average","threshold":4294967296}}}}},"AlarmTopicArn":{"id":"AlarmTopicArn","path":"MonitoringStack/AlarmTopicArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.213.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"MonitoringStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"MonitoringStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.213.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"MonitoringStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.213.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"MonitoringStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.213.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}